<!DOCTYPE html>
<html lang="en">

	<head>
		<title>rake/history</title>
		<meta charset="utf-8">
		<meta name="author" content="AppleGamer22">
		<meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
		<meta name="color-scheme" content="dark light">
		<meta name="format-detection" content="telephone=no">
		<meta name="msapplication-tap-highlight" content="no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="white">
		<meta name="theme-color" content="#0cd1e8">
		<meta name="twitter:title" content="Rake Instagram">
		<meta name="og:title" content="Rake Instagram">
		<meta name="og:site_name" content="Rake Instagram">
		<meta name="og:type" content="website">
		<meta http-equiv="Content-Type" content="text/html">
		<link rel="apple-touch-icon" href="/assets/icons/icon-ios-192x192.png">
		<link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico">
		<!-- <link rel="manifest" href="/manifest.json"> -->
		<link href="/assets/theme.css" rel="stylesheet">
		<link rel="stylesheet" href="/assets/dark.css">
		<script defer src="/assets/bootstrap.bundle.min.js"></script>
		<style>
			h1, h2, h3, h4, h5, h6, label, p, a {
				word-wrap: break-word;
			}
			img, video {
				height: auto;
				max-width: 33vw;
			}
			input#owner {
				width: calc(100% - 68px - 80px);
			}
		</style>
	</head>
	<body>
		<header>
			<nav class="navbar navbar-expand-lg">
				<div class="container-fluid">
					<a class="navbar-brand">
						<img src="/assets/icons/logo.svg" width="30" height="24" class="d-inline-block align-text-top">
						<sup>
							<span class="badge bg-secondary">{{.Version}}</span>
						</sup>
					</a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarNav">
						<ul class="navbar-nav">
							<li class="nav-item">
								<a class="nav-link" href="/">Authentication</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="/instagram">Instagram Post</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="/highlight">Instagram Highlight</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="/story">Instagram Story</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="/tiktok">TikTok Post</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="/vsco">VSCO Post</a>
							</li>
							<li class="nav-item">
								<a class="nav-link disabled" href="/history">History</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		</header>
		<main>
			<form>
				<div class="accordion" id="accordion_search">
					<div class="accordion-item">
						<h2 class="accordion-header" id="heading_search">
							<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse_search">
								Categories:&nbsp;<b>{{range $category, $checked := .Categories}}
									{{if $checked}}
										{{$category}}
									{{end}}
								{{end}}</b>
								&nbsp;
								Types:&nbsp;<b>{{range $mediaType, $checked := .Types}}
									{{if $checked}}
										{{$mediaType}}
									{{end}}
								{{end}}</b>
							</button>
						</h2>
						<div id="collapse_search" class="accordion-collapse collapse" data-bs-parent="#accordion_search">
							<div class="accordion-body">
								<h4>Categories</h4>
								{{range $category, $checked := .Categories}}
									{{if $checked}}
										<input type="checkbox" id="{{$category}}" name="{{$category}}" value="{{$category}}" checked>
									{{else}}
										<input type="checkbox" id="{{$category}}" name="{{$category}}" value="{{$category}}">
									{{end}}
									<label for="{{$category}}">{{$category}}</label>
									<br>
								{{end}}
								<h4>Media Types</h4>
								{{range $mediaType, $checked := .Types}}
									{{if $checked}}
										<input type="checkbox" id="{{$mediaType}}" name="{{$mediaType}}" value="{{$mediaType}}" checked>
									{{else}}
										<input type="checkbox" id="{{$mediaType}}" name="{{$mediaType}}" value="{{$mediaType}}">
									{{end}}
									{{if eq $mediaType "instagram"}}
										<label for="instagram">Instagram Post</label>
									{{end}}
									{{if eq $mediaType "highlight"}}
										<label for="highlight">Instagram Highlight</label>
									{{end}}
									{{if eq $mediaType "story"}}
										<label for="story">Instagram Story</label>
									{{end}}
									{{if eq $mediaType "tiktok"}}
										<label for="tiktok">TikTok Post</label>
									{{end}}
									{{if eq $mediaType "vsco"}}
										<label for="vsco">VSCO Post</label>
									{{end}}
									<br>
								{{end}}
							</div>
						</div>
					</div>
				</div>
				<h4>Owner</h4>
				<input type="text" value="{{.Owner}}" class="form-control float-start" placeholder="owner" id="owner" name="owner">
				<button type="reset" class="btn btn-warning">Reset</button>
				<button type="submit" class="btn btn-primary float-end">Submit</button>
			</form>
			{{range .Errors}}
				{{if .}}
					<h3 class="text-danger">{{.}}</h3>
				{{end}}
			{{end}}
			<div class="container-fluid">
				{{range $i, $row := .Histories}}
					<div class="row">
						{{range $ii, $history := $row}}
							<div class="col">
								<a href="/{{.Type}}?owner={{.Owner}}&post={{.Post}}">/{{.Type}}?owner={{.Owner}}&post={{.Post}}</a>
								<br>
								{{.Date.Local}}
								<br>
								{{if $history.Categories}}
									Categories: <b>{{range $category := $history.Categories}}
										{{$category}}
									{{end}}</b>
								{{end}}
								<div id="carousel_{{.Post}}" class="carousel slide" data-bs-interval="false">
									{{if gt (len .URLs) 1}}
										<div class="carousel-indicators">
											{{range $iii, $url := .URLs}}
												{{if eq $iii 0}}
													<button type="button" data-bs-target="#carousel_{{$history.Post}}" data-bs-slide-to="{{$iii}}" class="active"></button>
												{{else}}
													<button type="button" data-bs-target="#carousel_{{$history.Post}}" data-bs-slide-to="{{$iii}}"></button>
												{{end}}
											{{end}}
										</div>
									{{end}}
									<div class="carousel-inner">
										{{range $iii, $url := .URLs}}
											<div class="carousel-item{{if eq $iii 0}} active{{end}}">
												{{if or (hasSuffix . ".jpg") (hasSuffix . ".webp")}}
													<img class="d-block w-100" src="/api/storage/{{$history.U_ID}}/{{$history.Type}}/{{$history.Owner}}/{{$url}}" loading="lazy">
												{{else if or (hasSuffix . ".mp4") (hasSuffix . ".webm")}}
													<video class="d-block w-100" src="/api/storage/{{$history.U_ID}}/{{$history.Type}}/{{$history.Owner}}/{{$url}}" preload="metadata" muted controls loop></video>
												{{else}}
													<a href="/api/storage/{{$history.U_ID}}/{{$history.Type}}/{{$history.Owner}}/{{$url}}">{{$url}}</a>
												{{end}}
											</div>
										{{end}}
									</div>
									{{if gt (len .URLs) 1}}
										<button class="carousel-control-prev" type="button" data-bs-target="#carousel_{{.Post}}" data-bs-slide="prev">
											<span class="carousel-control-prev-icon"></span>
											<span class="visually-hidden">Previous</span>
										</button>
										<button class="carousel-control-next" type="button" data-bs-target="#carousel_{{.Post}}" data-bs-slide="next">
											<span class="carousel-control-next-icon"></span>
											<span class="visually-hidden">Next</span>
										</button>
									{{end}}
								</div>
							</div>
						{{end}}
					</div>
				{{end}}
			</div>
			<form>
				<nav>
					<ul class="pagination">
						<li class="page-item">
							<a class="page-link{{if eq .Page 1}} disabled{{end}}">1</a>
						</li>
						<li class="page-item">
							<a class="page-link{{if eq .Page 1}} disabled{{end}}">Previous</a>
						</li>
						<li class="page-item disabled">
							<a class="page-link">{{.Page}}</a>
						</li>
						<li class="page-item">
							<a class="page-link{{if eq .Page .Pages}} disabled{{end}}">Next</a>
						</li>
						<li class="page-item">
							<a class="page-link{{if eq .Page .Pages}} disabled{{end}}">{{.Pages}}</a>
						</li>
					</ul>
				</nav>
			</form>
		</main>
		<noscript>Please enable JavaScript to continue using this application.</noscript>
	</body>
</html>